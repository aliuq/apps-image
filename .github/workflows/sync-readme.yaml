name: Update README

on:
  push:
    branches:
      - master
    paths:
      - apps/*/README.md

jobs:
  sync-readme:
    runs-on: ubuntu-latest
    permissions:
      contents: write
    steps:
      - name: Checkout
        uses: actions/checkout@v4
        with:
          fetch-depth: 0 # 获取完整历史记录

      - name: Prepare
        id: prepare
        uses: aliuq/script-action@v1.0.5-beta.5
        with:
          auto_install: true
          script: |
            // 获取最近一次提交的文件
            const changedFiles = await execCommand(`git -C ${process.env.GITHUB_WORKSPACE} diff-tree --no-commit-id --name-only -r HEAD`)
            console.log('changedFiles:', changedFiles)

      # - name: Sync README
      #   uses: peter-evans/dockerhub-description@v4
      #   with:
      #     username: ${{ secrets.DOCKERHUB_USERNAME }}
      #     password: ${{ secrets.DOCKERHUB_TOKEN }}
      #     repository: ${{ steps.prep.outputs.repo }}
      #     readme-filepath: ${{ steps.prep.outputs.readme_path }}
